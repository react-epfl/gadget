<?xml version="1.0" encoding="UTF-8"?>
<Module>
  <ModulePrefs title="Sismondi App" 
                author_email="wissam.halimi@epfl.ch" 
                author="Wissam Halimi" 
                description="Gadget that sketches satellites' trajectories using positions' coordinates. Data is retrieved from the NASA website."
                width="500"
                height="500"
                thumbnail="http://iamac115.epfl.ch/Sismondi/satellite.png"
                screenshot="http://iamac115.epfl.ch/Sismondi/satellite.png">
    <Require feature="osapi" />
    <Require feature="dynamic-height" />
  </ModulePrefs>
  <Content type="html" view="default,canvas,home,profile"><![CDATA[

<style type="text/css">
</style>
  
<div id="graphs"></div>
<div id="graphdiv"></div>
<div id="container" style="width:100%; height:400px;"></div>
<button id="button">Get number of selected points</button>


<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
<!-- <script type="text/javascript" src="http://graasp.epfl.ch/gadgets/js/shindig-container:rpc.js?c=1&debug=1&nocache=1"></script> -->

<!-- <script type="text/javascript" src="http://iamac115.epfl.ch/sismondi_webserver/dygraph-combined.js"></script> -->

<script src="http://code.highcharts.com/highcharts.js"></script>
<script src="http://code.highcharts.com/modules/exporting.js"></script>

<script type="text/javascript">

  function buildGraph(data){

  //GET
  osapi.http.get({
    href: "http://iamac115.epfl.ch/Sismondi/test.txt",
    'format': "text"
    }).execute(function(result) {
      alert("here2");
      
          if (!result.error) {
            alert('success!');
            alert(result.content);
            }
            else{
            alert("Not working" + result.content.message);
            }
          });

  $('#container').highcharts({
              chart: {
                  type: 'scatter',
                  zoomType: 'xyz'
              },
              title: {
                  text: 'Ellipse scatter'
              },
              subtitle: {
                  text: 'Source: NASA 2013'
              },
              xAxis: {
                  title: {
                      enabled: true,
                      text: 'X (km)'
                  },
                  startOnTick: true,
                  endOnTick: true,
                  showLastLabel: true
              },
              yAxis: {
                  title: {
                      text: 'Y (km)'
                  }
              },
              legend: {
                  layout: 'vertical',
                  align: 'left',
                  verticalAlign: 'top',
                  x: 100,
                  y: 70,
                  floating: true,
                  backgroundColor: '#FFFFFF',
                  borderWidth: 1
              },
              plotOptions: {
                  scatter: {
                    allowPointSelect: true,
                      marker: {
                          radius: 5,
                          states: {
                              hover: {
                                  enabled: true,
                                  lineColor: 'rgb(100,100,100)'
                              }
                          }
                      },
                      states: {
                          hover: {
                              marker: {
                                  enabled: false
                              }
                          }
                      },
                      tooltip: {
                          headerFormat: '<b>{series.name}</b><br>',
                          pointFormat: '{point.x} km, {point.y} km, {point.z} hr'
                      }
                  }
              },
              series: [{
                  name: 'Ellipse',
                  color: 'rgba(223, 83, 83, .5)',
                  data: [[-0.5,4.9,1], [-0.5,-4.9,1],[-1,4.8,1], [-1.5,4.4,1], [-2,3.5,1],
                      [-2.5,2.5,1], [-3,0,1], [-2.5,-2.5,1], [-2,-3.5,1], [-1.5,-4.4,1],
                      [-1, -4.8,1], [0,-5,1], [0,5,1], [0.5,4.9,1], [0.5,-4.9,1], [1,4.8,1], [1.5,4.4,1], [2,3.5,1],
                      [2.5,2.5,1], [3,0,1], [2.5,-2.5,1], [2,-3.5,1], [1.5,-4.4,1],
                      [1, -4.8,1], [0,-5,1]]

              }]
          });

   var graph = $("<div id='hi'></div>")
   graph.appendTo(('#graphs'));
   var title = $("<div id='wissam'></div>").text(data);
    title.appendTo(graph);
    
    $('#button').click(function() {
    var chart = $('#container').highcharts();
      var selectedPoints = chart.getSelectedPoints();
      alert ('You selected '+ selectedPoints.length +' points');
      alert(selectedPoints.toString());
    });
  }

var data = "";
</script>

<script type="text/javascript">
// gets the data and calls build for container
var initialize = function() {
  
  buildGraph(data); 
  gadgets.window.adjustHeight();
};
</script>

<script type="text/javascript">
gadgets.util.registerOnLoadHandler(initialize);
</script>


  ]]></Content>
</Module>