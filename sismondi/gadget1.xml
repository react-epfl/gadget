<?xml version="1.0" encoding="UTF-8"?>
<Module>
  <ModulePrefs title="Sismondi App" 
                author_email="wissam.halimi@epfl.ch" 
                author="Wissam Halimi" 
                description="Gadget that sketches satellites' trajectories using positions' coordinates. Data is retrieved from the NASA website."
                width="500"
                height="500"
                thumbnail="http://iamac115.epfl.ch/sismondi_webserver/satellite.png"
                screenshot="http://iamac115.epfl.ch/sismondi_webserver/satellite.png">
    <Require feature="osapi" />
    <Require feature="dynamic-height" />
  </ModulePrefs>
  <Content type="html" view="default,canvas,home,profile"><![CDATA[

<style type="text/css">
</style>
  
<div id="graphs"></div>
<div id="graphdiv"></div>
<div id="container" style="width:100%; height:400px;"></div>

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
<!-- <script type="text/javascript" src="http://graasp.epfl.ch/gadgets/js/shindig-container:rpc.js?c=1&debug=1&nocache=1"></script> -->

<script type="text/javascript" src="http://iamac115.epfl.ch/sismondi_webserver/dygraph-combined.js"></script>

<script src="http://code.highcharts.com/highcharts.js"></script>
<script src="http://code.highcharts.com/modules/exporting.js"></script>

<script type="text/javascript">

  function buildGraph(data){

	var popupWindow;
	var url = "";
	function newPopup() {
	    if (popupWindow) popupWindow.close();

	    popupWindow = window.open(url, 'popUpWindow', 'height=700,width=800,left=10,top=10');
	}

	//GET
	//var request = "http://iamac115.epfl.ch/abc.txt";
	//alert("here");
	osapi.http.get({
		url: "http://iamac115.epfl.ch/abc.txt",
		'format': "text"
		}).execute(function(result) {
			alert("here2");
			
	  			if (!result.error) {
	    			alert('success!');
	    			console.log(result);
	    			window.open(result.content);
	  				}
	else
	{
	alert("not working");
	}
	});

	$('#container').highcharts({
	            chart: {
	                type: 'scatter',
	                zoomType: 'xy'
	            },
	            title: {
	                text: 'Ellipse scatter'
	            },
	            subtitle: {
	                text: 'Source: NASA 2013'
	            },
	            xAxis: {
	                title: {
	                    enabled: true,
	                    text: 'X (km)'
	                },
	                startOnTick: true,
	                endOnTick: true,
	                showLastLabel: true
	            },
	            yAxis: {
	                title: {
	                    text: 'Y (km)'
	                }
	            },
	            legend: {
	                layout: 'vertical',
	                align: 'left',
	                verticalAlign: 'top',
	                x: 100,
	                y: 70,
	                floating: true,
	                backgroundColor: '#FFFFFF',
	                borderWidth: 1
	            },
	            plotOptions: {
	                scatter: {
	                    marker: {
	                        radius: 5,
	                        states: {
	                            hover: {
	                                enabled: true,
	                                lineColor: 'rgb(100,100,100)'
	                            }
	                        }
	                    },
	                    states: {
	                        hover: {
	                            marker: {
	                                enabled: false
	                            }
	                        }
	                    },
	                    tooltip: {
	                        headerFormat: '<b>{series.name}</b><br>',
	                        pointFormat: '{point.x} km, {point.y} km'
	                    }
	                }
	            },
	            series: [{
	                name: 'Ellipse',
	                color: 'rgba(223, 83, 83, .5)',
	                data: [[-0.5,4.9], [-0.5,-4.9],[-1,4.8], [-1.5,4.4], [-2,3.5],
	                    [-2.5,2.5], [-3,0], [-2.5,-2.5], [-2,-3.5], [-1.5,-4.4],
	                    [-1, -4.8], [0,-5], [0,5], [0.5,4.9], [0.5,-4.9], [1,4.8], [1.5,4.4], [2,3.5],
	                    [2.5,2.5], [3,0], [2.5,-2.5], [2,-3.5], [1.5,-4.4],
	                    [1, -4.8], [0,-5]]

	            }]
	        });
	

    // CSV or path to a CSV file.
    				 //"X,Z\n" +
				//	"0,5\n" +
				//	"0.5,4.9\n" +
				//	"1,4.8\n" +
				//	"1.5,4.4\n" +
				//	"2,3.5\n" +
				//	"2.5,2.5\n" +
				//	"3,0\n"+
			//		"2.5,-2.5\n" +
			//		"2,-3.5\n" +
			//	//	"1.5,-4.4\n" +
			//		"1, -4.8\n" +
			//		"0,-5\n"
  //);


	//alert(data);
   var x = data1.x;
   var y = data1.y;
	//alert(data1.x[0]);
   var name = data1.name;
   var graph = $("<div id='hi'></div>")
   graph.appendTo(('#graphs'));
   var me = "YOUHOU";
   var title = $("<div id='wissam'></div>").text(data);
		title.appendTo(graph);

	
  }

var data1 = 
      {
        x: [-2,0,0,1,1,2],
        y: [0,-4,4,-3.46,3.46,0],
        name:"Ellipse"
      }

var data = "";
    
</script>

<script type="text/javascript">
var isOwner = false;

// gets the data and calls build for container
var initialize = function() {
  
  buildGraph(data); 
  gadgets.window.adjustHeight();
};

</script>

<script type="text/javascript">
gadgets.util.registerOnLoadHandler(initialize);
</script>


  ]]></Content>
</Module>